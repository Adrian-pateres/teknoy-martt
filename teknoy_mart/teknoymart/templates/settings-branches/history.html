{% extends "teknoymart/base.html" %}{% load static %}{% block title %}Transaction History | Teknoy Mart{% endblock %}{% block content %}<div class="history-container">  <!-- Animated Header with Stats -->  <div class="history-header">    <div class="header-content">      <h1>Transaction History</h1>      <p class="subtitle">Track and manage all your transactions in one place</p>    </div>        <div class="stats-grid">      <div class="stat-card">        <div class="stat-icon purchases">          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">            <path d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>          </svg>        </div>        <div class="stat-info">          <div class="stat-value">{{ total_purchases|default:0 }}</div>          <div class="stat-label">Total Purchases</div>        </div>      </div>      <div class="stat-card">        <div class="stat-icon sales">          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>          </svg>        </div>        <div class="stat-info">          <div class="stat-value">{{ total_sales|default:0 }}</div>          <div class="stat-label">Total Sales</div>        </div>      </div>      <div class="stat-card">        <div class="stat-icon revenue">          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">            <path d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>          </svg>        </div>        <div class="stat-info">          <div class="stat-value">â‚±{{ total_revenue|floatformat:2|default:"0.00" }}</div>          <div class="stat-label">Total Revenue</div>        </div>      </div>      <div class="stat-card">        <div class="stat-icon pending">          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>            <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>          </svg>        </div>        <div class="stat-info">          <div class="stat-value">{{ pending_count|default:0 }}</div>          <div class="stat-label">Pending</div>        </div>      </div>    </div>  </div>  <!-- Enhanced Filter Tabs with Icons -->  <div class="filter-tabs">    <button class="tab-btn active" onclick="filterTransactions('all')" data-filter="all">      <svg width="18" height="18" viewBox="0 0 18 18" fill="none">        <rect x="2" y="2" width="14" height="14" rx="2" stroke="currentColor" stroke-width="2"/>        <path d="M6 9h6M9 6v6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>      </svg>      <span>All Transactions</span>      <span class="count">{{ transactions.paginator.count|default:0 }}</span>    </button>    <button class="tab-btn" onclick="filterTransactions('purchases')" data-filter="purchases">      <svg width="18" height="18" viewBox="0 0 18 18" fill="none">        <path d="M14 6H4a1 1 0 00-1 1v8a1 1 0 001 1h10a1 1 0 001-1V7a1 1 0 00-1-1z" stroke="currentColor" stroke-width="2"/>        <path d="M12 4V3a2 2 0 00-2-2H8a2 2 0 00-2 2v1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>      </svg>      <span>Purchases</span>    </button>    <button class="tab-btn" onclick="filterTransactions('sales')" data-filter="sales">      <svg width="18" height="18" viewBox="0 0 18 18" fill="none">        <path d="M9 2v14M13 4H7.5a2.5 2.5 0 000 5h3a2.5 2.5 0 010 5H5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>      </svg>      <span>Sales</span>    </button>    <button class="tab-btn" onclick="filterTransactions('pending')" data-filter="pending">      <svg width="18" height="18" viewBox="0 0 18 18" fill="none">        <circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="2"/>        <path d="M9 5v4l2 2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>      </svg>      <span>Pending</span>    </button>  </div>  <!-- Enhanced Search and Controls -->  <div class="controls-bar">    <div class="search-box">      <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">        <circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="2"/>        <path d="M19 19l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>      </svg>      <input type="text" id="searchInput" placeholder="Search by product or user..." onkeyup="searchTransactions()">      <button class="clear-search" onclick="clearSearch()" style="display: none;">        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">          <path d="M12 4L4 12M4 4l8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>        </svg>      </button>    </div>        <div class="filter-group">      <select class="sort-select" onchange="sortTransactions(this.value)">        <option value="newest">ðŸ“… Newest First</option>        <option value="oldest">ðŸ“… Oldest First</option>        <option value="highest">ðŸ’° Highest Amount</option>        <option value="lowest">ðŸ’° Lowest Amount</option>      </select>            <button class="export-btn" onclick="exportTransactions()">        <svg width="18" height="18" viewBox="0 0 18 18" fill="none">          <path d="M16 11v4a1 1 0 01-1 1H3a1 1 0 01-1-1v-4M13 6l-4-4m0 0L5 6m4-4v10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>        </svg>        Export      </button>    </div>  </div>  <!-- Enhanced Transaction List -->  <div class="transactions-list" id="transactionsList">    {% if transactions %}      {% for transaction in transactions %}      <div class="transaction-card" data-type="{{ transaction.type }}" data-status="{{ transaction.status }}">        <div class="card-ribbon {{ transaction.status }}">{{ transaction.status|title }}</div>                <div class="transaction-main">          <div class="transaction-left">            <div class="transaction-image">              {% if transaction.product.image %}                <img src="{{ transaction.product.image.url }}" alt="{{ transaction.product.name }}" loading="lazy">              {% else %}                <div class="placeholder-image">                  <svg width="40" height="40" viewBox="0 0 40 40" fill="none">                    <rect width="40" height="40" rx="8" fill="#f0f0f0"/>                    <path d="M15 25l5-5 5 5M20 20v10" stroke="#999" stroke-width="2" stroke-linecap="round"/>                  </svg>                </div>              {% endif %}              <div class="type-badge {{ transaction.type }}">                {% if transaction.type == 'purchase' %}                  <svg width="14" height="14" viewBox="0 0 14 14" fill="none">                    <path d="M11 5H3a1 1 0 00-1 1v6a1 1 0 001 1h8a1 1 0 001-1V6a1 1 0 00-1-1z" stroke="currentColor" stroke-width="1.5"/>                    <path d="M9 3V2a1 1 0 00-1-1H6a1 1 0 00-1 1v1" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>                  </svg>                {% else %}                  <svg width="14" height="14" viewBox="0 0 14 14" fill="none">                    <path d="M7 2v10M10 4H6a2 2 0 000 4h2a2 2 0 010 4H4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>                  </svg>                {% endif %}              </div>            </div>                        <div class="transaction-details">              <h3 class="product-name">{{ transaction.product.name }}</h3>              <div class="transaction-meta">                <span class="meta-item">                  <svg width="14" height="14" viewBox="0 0 14 14" fill="none">                    <circle cx="7" cy="7" r="6" stroke="currentColor" stroke-width="1.5"/>                    <path d="M7 3.5v3.5l2 2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>                  </svg>                  {{ transaction.created_at|date:"M d, Y" }}                </span>                <span class="meta-item">                  <svg width="14" height="14" viewBox="0 0 14 14" fill="none">                    <circle cx="7" cy="4" r="2.5" stroke="currentColor" stroke-width="1.5"/>                    <path d="M2 12a5 5 0 0110 0" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>                  </svg>                  {% if transaction.type == 'purchase' %}                    {{ transaction.seller.get_full_name|default:transaction.seller.username }}                  {% else %}                    {{ transaction.buyer.get_full_name|default:transaction.buyer.username }}                  {% endif %}                </span>              </div>              <div class="transaction-tags">                <span class="tag {{ transaction.type }}">{{ transaction.type|title }}</span>                {% if transaction.payment_method %}                  <span class="tag payment">{{ transaction.payment_method }}</span>                {% endif %}              </div>            </div>          </div>                    <div class="transaction-right">            <div class="amount-section">              <div class="amount-label">Amount</div>              <div class="transaction-amount">â‚±{{ transaction.amount|floatformat:2 }}</div>            </div>                        <div class="action-buttons">              <a href="{% url 'transaction_detail' transaction.id %}" class="btn-action primary">                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">                  <path d="M1 8s3-5 7-5 7 5 7 5-3 5-7 5-7-5-7-5z" stroke="currentColor" stroke-width="1.5"/>                  <circle cx="8" cy="8" r="2.5" stroke="currentColor" stroke-width="1.5"/>                </svg>                View Details              </a>              {% if transaction.status == 'pending' and transaction.type == 'sale' %}              <button class="btn-action secondary" onclick="updateStatus({{ transaction.id }})">                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">                  <path d="M13.5 4.5L6 12L2.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>                </svg>                Complete              </button>              {% endif %}            </div>          </div>        </div>        <div class="transaction-footer">          <div class="footer-info">            <span class="info-item">              <strong>Transaction ID:</strong> #{{ transaction.id|stringformat:"05d" }}            </span>            <span class="info-item">              <strong>Time:</strong> {{ transaction.created_at|date:"h:i A" }}            </span>          </div>          {% if transaction.notes %}          <button class="show-notes" onclick="toggleNotes({{ transaction.id }})">            <svg width="14" height="14" viewBox="0 0 14 14" fill="none">              <path d="M12 7H2M7 2v10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>            </svg>            Show Notes          </button>          {% endif %}        </div>        {% if transaction.notes %}        <div class="transaction-notes" id="notes-{{ transaction.id }}" style="display: none;">          <div class="notes-content">            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">              <path d="M12 2H4a1 1 0 00-1 1v10a1 1 0 001 1h8a1 1 0 001-1V3a1 1 0 00-1-1z" stroke="currentColor" stroke-width="1.5"/>              <path d="M5 6h6M5 9h6M5 12h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>            </svg>            <p>{{ transaction.notes }}</p>          </div>        </div>        {% endif %}      </div>      {% endfor %}    {% else %}      <div class="empty-state">        <div class="empty-illustration">          <svg width="200" height="200" viewBox="0 0 200 200" fill="none">            <circle cx="100" cy="100" r="80" fill="#f8f8f8"/>            <path d="M70 90h60M70 110h45" stroke="#ddd" stroke-width="4" stroke-linecap="round"/>            <rect x="60" y="75" width="80" height="50" rx="8" stroke="#ddd" stroke-width="3" fill="none"/>            <circle cx="140" cy="60" r="20" fill="#8B0000" opacity="0.1"/>            <path d="M140 50v20M130 60h20" stroke="#8B0000" stroke-width="3" stroke-linecap="round"/>          </svg>        </div>        <h3>No Transactions Found</h3>        <p>Your transaction history will appear here once you start buying or selling items on Teknoy Mart.</p>        <div class="empty-actions">          <a href="{% url 'guest_home' %}" class="btn-primary">            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">              <path d="M15 7H3a1 1 0 00-1 1v7a1 1 0 001 1h12a1 1 0 001-1V8a1 1 0 00-1-1z" stroke="currentColor" stroke-width="2"/>              <path d="M12 5V4a2 2 0 00-2-2H8a2 2 0 00-2 2v1" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>            </svg>            Browse Products          </a>          <a href="{% url 'add_product' %}" class="btn-secondary">            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">              <path d="M9 3v12M3 9h12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>            </svg>            List a Product          </a>        </div>      </div>    {% endif %}  </div>  <!-- Enhanced Pagination -->  {% if transactions and transactions.paginator.num_pages > 1 %}  <div class="pagination">    {% if transactions.has_previous %}      <a href="?page=1" class="page-btn" title="First Page">        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">          <path d="M11 12L7 8l4-4M8 12L4 8l4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>        </svg>      </a>      <a href="?page={{ transactions.previous_page_number }}" class="page-btn" title="Previous">        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">          <path d="M10 12L6 8l4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>        </svg>        Previous      </a>    {% endif %}        <div class="page-numbers">      {% for num in transactions.paginator.page_range %}        {% if transactions.number == num %}          <span class="page-number active">{{ num }}</span>        {% elif num > transactions.number|add:'-3' and num < transactions.number|add:'3' %}          <a href="?page={{ num }}" class="page-number">{{ num }}</a>        {% endif %}      {% endfor %}    </div>        {% if transactions.has_next %}      <a href="?page={{ transactions.next_page_number }}" class="page-btn" title="Next">        Next        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">          <path d="M6 12l4-4-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>        </svg>      </a>      <a href="?page={{ transactions.paginator.num_pages }}" class="page-btn" title="Last Page">        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">          <path d="M5 12l4-4-4-4M8 12l4-4-4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>        </svg>      </a>    {% endif %}  </div>  {% endif %}</div><style>  * {    margin: 0;    padding: 0;    box-sizing: border-box;  }  .history-container {    max-width: 1400px;    margin: 80px auto 40px;    padding: 0 24px;    animation: fadeIn 0.5s ease-in-out;  }  /* Enhanced Header */  .history-header {    margin-bottom: 40px;  }  .header-content {    text-align: center;    margin-bottom: 40px;  }  .history-header h1 {    font-size: 3rem;    color: #1a1a1a;    margin-bottom: 12px;    font-weight: 800;    background: linear-gradient(135deg, #8B0000 0%, #DC143C 100%);    -webkit-background-clip: text;    -webkit-text-fill-color: transparent;    background-clip: text;  }  .subtitle {    color: #666;    font-size: 1.15rem;    font-weight: 500;  }  /* Stats Grid */  .stats-grid {    display: grid;    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));    gap: 20px;    margin-bottom: 40px;  }  .stat-card {    background: white;    border-radius: 16px;    padding: 24px;    display: flex;    align-items: center;    gap: 20px;    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);    transition: all 0.3s ease;    position: relative;    overflow: hidden;  }  .stat-card::before {    content: '';    position: absolute;    top: 0;    left: 0;    width: 4px;    height: 100%;    background: linear-gradient(180deg, #8B0000, #DC143C);    opacity: 0;    transition: opacity 0.3s;  }  .stat-card:hover {    transform: translateY(-4px);    box-shadow: 0 8px 24px rgba(139, 0, 0, 0.15);  }  .stat-card:hover::before {    opacity: 1;  }  .stat-icon {    width: 56px;    height: 56px;    border-radius: 14px;    display: flex;    align-items: center;    justify-content: center;    flex-shrink: 0;  }  .stat-icon.purchases {    background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);    color: #1976d2;  }  .stat-icon.sales {    background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);    color: #388e3c;  }  .stat-icon.revenue {    background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);    color: #f57c00;  }  .stat-icon.pending {    background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 100%);    color: #c2185b;  }  .stat-info {    flex: 1;  }  .stat-value {    font-size: 2rem;    font-weight: 800;    color: #1a1a1a;    line-height: 1;    margin-bottom: 6px;  }  .stat-label {    font-size: 0.95rem;    color: #666;    font-weight: 600;  }  /* Enhanced Filter Tabs */  .filter-tabs {    display: flex;    gap: 12px;    margin-bottom: 30px;    flex-wrap: wrap;    padding: 8px;    background: white;    border-radius: 16px;    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);  }  .tab-btn {    flex: 1;    min-width: 180px;    padding: 14px 24px;    border: 2px solid transparent;    background: transparent;    border-radius: 12px;    font-weight: 600;    font-size: 0.95rem;    cursor: pointer;    transition: all 0.3s;    color: #666;    display: flex;    align-items: center;    justify-content: center;    gap: 8px;    position: relative;  }  .tab-btn svg {    transition: transform 0.3s;  }  .tab-btn.active {    background: linear-gradient(135deg, #8B0000 0%, #a40000 100%);    color: white;    box-shadow: 0 4px 12px rgba(139, 0, 0, 0.3);  }  .tab-btn.active svg {    transform: scale(1.1);  }  .tab-btn:hover:not(.active) {    background: #f5f5f5;    color: #8B0000;    border-color: #8B0000;  }  .tab-btn .count {    background: rgba(255, 255, 255, 0.2);    padding: 2px 8px;    border-radius: 10px;    font-size: 0.85rem;    font-weight: 700;  }  .tab-btn.active .count {    background: rgba(255, 255, 255, 0.25);  }  /* Enhanced Controls Bar */  .controls-bar {    display: flex;    gap: 16px;    margin-bottom: 30px;    flex-wrap: wrap;  }  .search-box {    flex: 1;    min-width: 300px;    position: relative;  }  .search-box input {    width: 100%;    padding: 14px 50px 14px 50px;    border: 2px solid #e0e0e0;    border-radius: 12px;    font-size: 1rem;    outline: none;    transition: all 0.3s;    background: white;  }  .search-box input:focus {    border-color: #8B0000;    box-shadow: 0 0 0 4px rgba(139, 0, 0, 0.1);  }  .search-icon {    position: absolute;    left: 18px;    top: 50%;    transform: translateY(-50%);    color: #999;    pointer-events: none;  }  .clear-search {    position: absolute;    right: 15px;    top: 50%;    transform: translateY(-50%);    background: #f0f0f0;    border: none;    border-radius: 50%;    width: 24px;    height: 24px;    display: flex;    align-items: center;    justify-content: center;    cursor: pointer;    transition: all 0.2s;  }  .clear-search:hover {    background: #8B0000;    color: white;  }  .filter-group {    display: flex;    gap: 12px;  }  .sort-select {    padding: 14px 20px;    border: 2px solid #e0e0e0;    border-radius: 12px;    font-size: 1rem;    cursor: pointer;    outline: none;    background: white;    font-weight: 600;    min-width: 200px;    transition: all 0.3s;  }  .sort-select:hover,  .sort-select:focus {    border-color: #8B0000;  }

  .export-btn {
    padding: 14px 24px;
    background: linear-gradient(135deg, #8B0000 0%, #a40000 100%);
    color: white;
    border: none;
    border-radius: 12px;
    font-weight: 700;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s;
    box-shadow: 0 4px 12px rgba(139, 0, 0, 0.2);
  }

  .export-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(139, 0, 0, 0.3);
  }

  /* Enhanced Transaction Cards */
  .transactions-list {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .transaction-card {
    background: white;
    border-radius: 20px;
    overflow: hidden;
    box-shadow: 0 2px 16px rgba(0, 0, 0, 0.08);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    animation: slideUp 0.4s ease-out;
  }

  .transaction-card:hover {
    box-shadow: 0 12px 32px rgba(139, 0, 0, 0.15);
    transform: translateY(-4px);
  }

  .card-ribbon {
    position: absolute;
    top: 20px;
    right: -35px;
    background: #2e7d32;
    color: white;
    padding: 6px 40px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transform: rotate(45deg);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }

  .card-ribbon.pending {
    background: #f57c00;
  }

  .card-ribbon.cancelled {
    background: #c62828;
  }

  .transaction-main {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 28px;
    gap: 24px;
  }

  .transaction-left {
    display: flex;
    gap: 24px;
    align-items: center;
    flex: 1;
  }

  .transaction-image {
    width: 100px;
    height: 100px;
    border-radius: 16px;
    overflow: hidden;
    flex-shrink: 0;
    background: #f5f5f5;
    position: relative;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  }

  .transaction-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s;
  }

  .transaction-card:hover .transaction-image img {
    transform: scale(1.05);
  }

  .placeholder-image {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .type-badge {
    position: absolute;
    bottom: -4px;
    right: -4px;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    border: 3px solid white;
  }

  .type-badge.purchase {
    background: linear-gradient(135deg, #1976d2, #2196f3);
    color: white;
  }

  .type-badge.sale {
    background: linear-gradient(135deg, #388e3c, #66bb6a);
    color: white;
  }

  .transaction-details {
    flex: 1;
  }

  .product-name {
    font-size: 1.35rem;
    color: #1a1a1a;
    margin-bottom: 12px;
    font-weight: 700;
    line-height: 1.3;
  }

  .transaction-meta {
    display: flex;
    gap: 20px;
    margin-bottom: 12px;
    flex-wrap: wrap;
  }

  .meta-item {
    display: flex;
    align-items: center;
    gap: 6px;
    color: #666;
    font-size: 0.9rem;
    font-weight: 500;
  }

  .meta-item svg {
    color: #999;
  }

  .transaction-tags {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .tag {
    display: inline-block;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .tag.purchase {
    background: linear-gradient(135deg, #e3f2fd, #bbdefb);
    color: #1976d2;
  }

  .tag.sale {
    background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
    color: #388e3c;
  }

  .tag.payment {
    background: linear-gradient(135deg, #fff3e0, #ffe0b2);
    color: #f57c00;
  }

  .transaction-right {
    text-align: right;
    display: flex;
    flex-direction: column;
    gap: 16px;
    align-items: flex-end;
  }

  .amount-section {
    background: linear-gradient(135deg, #fef5f5, #ffe5e5);
    padding: 16px 24px;
    border-radius: 12px;
    border: 2px solid #ffe0e0;
  }

  .amount-label {
    font-size: 0.8rem;
    color: #8B0000;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 4px;
  }

  .transaction-amount {
    font-size: 2rem;
    font-weight: 900;
    color: #8B0000;
    line-height: 1;
  }

  .action-buttons {
    display: flex;
    gap: 10px;
  }

  .btn-action {
    padding: 12px 20px;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 700;
    font-size: 0.9rem;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    gap: 8px;
    border: none;
    cursor: pointer;
  }

  .btn-action.primary {
    background: linear-gradient(135deg, #8B0000, #a40000);
    color: white;
    box-shadow: 0 4px 12px rgba(139, 0, 0, 0.2);
  }

  .btn-action.primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(139, 0, 0, 0.3);
  }

  .btn-action.secondary {
    background: white;
    color: #8B0000;
    border: 2px solid #8B0000;
  }

  .btn-action.secondary:hover {
    background: #8B0000;
    color: white;
  }

  /* Transaction Footer */
  .transaction-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 28px;
    background: #f9f9f9;
    border-top: 1px solid #eee;
  }

  .footer-info {
    display: flex;
    gap: 24px;
    flex-wrap: wrap;
  }

  .info-item {
    font-size: 0.85rem;
    color: #666;
  }

  .info-item strong {
    color: #1a1a1a;
    font-weight: 700;
  }

  .show-notes {
    background: transparent;
    border: 2px solid #8B0000;
    color: #8B0000;
    padding: 8px 16px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.3s;
  }

  .show-notes:hover {
    background: #8B0000;
    color: white;
  }

  .transaction-notes {
    padding: 20px 28px;
    background: #fffbf0;
    border-top: 1px solid #fff3cd;
  }

  .notes-content {
    display: flex;
    gap: 12px;
    align-items: flex-start;
  }

  .notes-content svg {
    color: #f57c00;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .notes-content p {
    color: #666;
    line-height: 1.6;
    font-size: 0.95rem;
  }

  /* Enhanced Empty State */
  .empty-state {
    text-align: center;
    padding: 80px 20px;
    background: white;
    border-radius: 20px;
    box-shadow: 0 2px 16px rgba(0, 0, 0, 0.06);
  }

  .empty-illustration {
    margin-bottom: 40px;
    animation: float 3s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  .empty-state h3 {
    font-size: 2rem;
    color: #1a1a1a;
    margin-bottom: 16px;
    font-weight: 800;
  }

  .empty-state p {
    color: #666;
    margin-bottom: 40px;
    font-size: 1.1rem;
    line-height: 1.6;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
  }

  .empty-actions {
    display: flex;
    gap: 16px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .btn-primary,
  .btn-secondary {
    padding: 14px 28px;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 700;
    font-size: 1rem;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s;
  }

  .btn-primary {
    background: linear-gradient(135deg, #8B0000, #a40000);
    color: white;
    box-shadow: 0 4px 16px rgba(139, 0, 0, 0.2);
  }

  .btn-primary:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 24px rgba(139, 0, 0, 0.3);
  }

  .btn-secondary {
    background: white;
    color: #8B0000;
    border: 2px solid #8B0000;
  }

  .btn-secondary:hover {
    background: #8B0000;
    color: white;
  }

  /* Enhanced Pagination */
  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 12px;
    margin-top: 50px;
    flex-wrap: wrap;
  }

  .page-btn {
    padding: 12px 20px;
    background: white;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    color: #8B0000;
    text-decoration: none;
    font-weight: 700;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .page-btn:hover {
    background: #8B0000;
    color: white;
    border-color: #8B0000;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(139, 0, 0, 0.2);
  }

  .page-numbers {
    display: flex;
    gap: 8px;
  }

  .page-number {
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    text-decoration: none;
    font-weight: 700;
    color: #666;
    background: white;
    border: 2px solid #e0e0e0;
    transition: all 0.3s;
  }

  .page-number:hover {
    border-color: #8B0000;
    color: #8B0000;
    background: #fff5f5;
  }

  .page-number.active {
    background: linear-gradient(135deg, #8B0000, #a40000);
    color: white;
    border-color: #8B0000;
    box-shadow: 0 4px 12px rgba(139, 0, 0, 0.2);
  }

  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Dark Mode */
  body.dark-mode .history-container {
    color: #fff;
  }

  body.dark-mode .history-header h1 {
    background: linear-gradient(135deg, #ff4444 0%, #ff6b6b 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  body.dark-mode .subtitle {
    color: #bbb;
  }

  body.dark-mode .stat-card {
    background: #1e1e1e;
  }

  body.dark-mode .stat-value {
    color: #fff;
  }

  body.dark-mode .filter-tabs {
    background: #1e1e1e;
  }

  body.dark-mode .tab-btn:hover:not(.active) {
    background: #2d2d2d;
  }

  body.dark-mode .search-box input,
  body.dark-mode .sort-select {
    background: #2d2d2d;
    border-color: #444;
    color: #fff;
  }

  body.dark-mode .transaction-card {
    background: #1e1e1e;
  }

  body.dark-mode .product-name {
    color: #fff;
  }

  body.dark-mode .meta-item,
  body.dark-mode .info-item {
    color: #bbb;
  }

  body.dark-mode .transaction-footer {
    background: #252525;
    border-top-color: #333;
  }

  body.dark-mode .empty-state {
    background: #1e1e1e;
  }

  body.dark-mode .empty-state h3 {
    color: #fff;
  }

  body.dark-mode .empty-state p {
    color: #bbb;
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 768px) {
    .history-header h1 {
      font-size: 2.2rem;
    }

    .stats-grid {
      grid-template-columns: 1fr;
    }

    .filter-tabs {
      flex-direction: column;
    }

    .tab-btn {
      min-width: 100%;
    }

    .controls-bar {
      flex-direction: column;
    }

    .filter-group {
      flex-direction: column;
    }

    .search-box,
    .sort-select,
    .export-btn {
      width: 100%;
    }

    .transaction-main {
      flex-direction: column;
      align-items: flex-start;
    }

    .transaction-right {
      width: 100%;
      align-items: stretch;
    }

    .amount-section {
      text-align: center;
    }

    .action-buttons {
      flex-direction: column;
    }

    .btn-action {
      width: 100%;
      justify-content: center;
    }

    .transaction-footer {
      flex-direction: column;
      gap: 16px;
    }

    .footer-info {
      flex-direction: column;
      gap: 8px;
      width: 100%;
    }

    .empty-actions {
      flex-direction: column;
      align-items: stretch;
    }

    .btn-primary,
    .btn-secondary {
      justify-content: center;
    }
  }
</style>

<script>
  // Filter transactions
  function filterTransactions(type) {
    const cards = document.querySelectorAll('.transaction-card');
    const buttons = document.querySelectorAll('.tab-btn');
    
    buttons.forEach(btn => btn.classList.remove('active'));
    event.target.closest('.tab-btn').classList.add('active');
    
    cards.forEach((card, index) => {
      card.style.animation = 'none';
      
      if (type === 'all') {
        card.style.display = 'block';
      } else if (type === 'purchases') {
        card.style.display = card.dataset.type === 'purchase' ? 'block' : 'none';
      } else if (type === 'sales') {
        card.style.display = card.dataset.type === 'sale' ? 'block' : 'none';
      } else if (type === 'pending') {
        card.style.display = card.dataset.status === 'pending' ? 'block' : 'none';
      }
      
      setTimeout(() => {
        card.style.animation = `slideUp 0.4s ease-out ${index * 0.05}s both`;
      }, 10);
    });
  }

  // Search transactions
  function searchTransactions() {
    const input = document.getElementById('searchInput');
    const filter = input.value.toLowerCase();
    const cards = document.querySelectorAll('.transaction-card');
    const clearBtn = document.querySelector('.clear-search');
    
    clearBtn.style.display = filter ? 'flex' : 'none';
    
    cards.forEach(card => {
      const productName = card.querySelector('.product-name').textContent.toLowerCase();
      const userName = card.querySelector('.meta-item:nth-child(2)').textContent.toLowerCase();
      
      if (productName.includes(filter) || userName.includes(filter)) {
        card.style.display = 'block';
      } else {
        card.style.display = 'none';
      }
    });
  }

  // Clear search
  function clearSearch() {
    document.getElementById('searchInput').value = '';
    document.querySelector('.clear-search').style.display = 'none';
    searchTransactions();
  }

  // Sort transactions
  function sortTransactions(sortType) {
    const container = document.getElementById('transactionsList');
    const cards = Array.from(container.querySelectorAll('.transaction-card'));
    
    cards.sort((a, b) => {
      const amountA = parseFloat(a.querySelector('.transaction-amount').textContent.replace('â‚±', '').replace(',', ''));
      const amountB = parseFloat(b.querySelector('.transaction-amount').textContent.replace('â‚±', '').replace(',', ''));
      
      const dateA = a.querySelector('.meta-item').textContent;
      const dateB = b.querySelector('.meta-item').textContent;
      
      switch(sortType) {
        case 'newest':
          return dateB.localeCompare(dateA);
        case 'oldest':
          return dateA.localeCompare(dateB);
        case 'highest':
          return amountB - amountA;
        case 'lowest':
          return amountA - amountB;
        default:
          return 0;
      }
    });
    
    cards.forEach((card, index) => {
      card.style.animation = 'none';
      container.appendChild(card);
      setTimeout(() => {
        card.style.animation = `slideUp 0.4s ease-out ${index * 0.05}s both`;
      }, 10);
    });
  }

  // Toggle notes
  function toggleNotes(id) {
    const notes = document.getElementById(`notes-${id}`);
    const button = event.target.closest('.show-notes');
    
    if (notes.style.display === 'none') {
      notes.style.display = 'block';
      button.innerHTML = `
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <path d="M12 7H2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        Hide Notes
      `;
    } else {
      notes.style.display = 'none';
      button.innerHTML = `
        <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
          <path d="M12 7H2M7 2v10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        Show Notes
      `;
    }
  }

  // Export transactions
  function exportTransactions() {
    // Implement export functionality (CSV, PDF, etc.)
    alert('Export feature coming soon!');
  }

  // Update transaction status
  function updateStatus(id) {
    if (confirm('Mark this transaction as completed?')) {
      // Send AJAX request to update status
      alert('Status update feature coming soon!');
    }
  }

  // Staggered animation on load
  document.addEventListener('DOMContentLoaded', function() {
    const cards = document.querySelectorAll('.transaction-card');
    cards.forEach((card, index) => {
      card.style.animation = `slideUp 0.4s ease-out ${index * 0.1}s both`;
    });
  });
</script>

{% endblock %}